<style>
  .product-gallery {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .product-image-wrapper {
    position: relative;
    display: inline-block;
  }

  .product__media {
    width: 100%;
    height: auto;
    display: block;
    border-radius: 4px;
  }

  .copy-button {
    position: absolute;
    top: 8px;
    right: 8px;
    background-color: rgba(0, 0, 0, 0.6);
    color: #fff;
    border: none;
    padding: 4px 6px;
    font-size: 12px;
    border-radius: 4px;
    cursor: pointer;
    z-index: 10;
    transition: background-color 0.2s, transform 0.2s;
  }

  .copy-button:hover {
    background-color: rgba(0, 0, 0, 0.85);
    transform: scale(1.05);
  }
</style>

<div class="product-gallery">
  {% for media in product.media %}
    {% if media.media_type == 'image' %}
      {% capture image_url %}
        {{ media | img_url: 'master' }}
      {% endcapture %}
      {% unless image_url contains 'http' %}
        {% assign image_url = image_url | prepend: request.origin %}
      {% endunless %}
      <div class="product-image-wrapper">
        <img 
          src="{{ image_url | strip }}" 
          alt="{{ media.alt | escape }}" 
          loading="lazy" 
          class="product__media"
        />
        <button 
          class="copy-button" 
          onclick="copyImageUrl('{{ image_url | strip }}', this)" 
          title="Copy image URL"
        >
          ðŸ“‹
        </button>
      </div>
    {% endif %}
  {% endfor %}
</div>

<script>
  function copyImageUrl(url, buttonElement) {
    navigator.clipboard.writeText(url).then(function () {
      const originalText = buttonElement.innerText;
      buttonElement.innerText = 'âœ…';
      setTimeout(() => {
        buttonElement.innerText = originalText;
      }, 1200);
    }).catch(function (err) {
      alert('Failed to copy image URL: ' + err);
    });
  }
</script>